# 初赛题目整理



## 1.1 企业占有率计算

### 任务详情

某企业的销售额为x万元,某企业所在市场行业销售额为y万元.我们需要计算该企业的市场占有率,需要将小数转换为百分数,并四舍五入保留小数点后2位.



### 任务要求

1.企业销售额X和行业销售额y均由后台给出;
2.返回结果需要以百分号形式呈现,并保留小数点后2位;
3.返回结果数据类型是字符串;
4.如果返回结果的数据关型不正确,那么他将是不对的.



### 测试用例

输入: X=205,y=566
输出: 36.22%
解释: 某企业销售额是205万元,它所在市场销售额是: 566万元,市场占有率是'36.22%'



输入: X=299,y=433
输出: 69.05%
解释: 某企业销售额是299万元,它所在市场销售额是: 433万元,市场占有率是'69.05%'



输入: X=130,y=484
输出: 26.86%



### 参考答案

```python
class Solution:
    
    def main(self, x, y):
        return format(x/y,".2%")

z = Solution()
print(z.main(130,484))

```



## 1.2字典的筛选

### 题目要求

请编写程序,将字典中的键按照对应值的大小,从大到小排列.如果值相同,对应键按照字母顺序表,先小写后大写的顺序排列;
1.程序接收dict数据类型的dict,返回结果的数据类型为tuple;
2.字典dict中键的数据类型为str,值的数据类型为int.

### 测试用例

输入: dict={"F:33,"r":33,"c":13,v":91,"n:33,"L":73}
输出: ("v",L","n","r",F","c")
解释: 在dict的值中,按照值从大到小排列依次是V,L,(f,r,),c,F,r和n按照字母顶序表和字母大小写排序结果是n,r和F,总结果如上.



输入: dict={"e:99,"V:84,"E":62}
输出: ('e","V",E")
解释: 如上键值对从大到小依次是e,V和E



输入: dict={"V":3,"E":70,"W":18,"k":16}
输出: ("E","W","k,"V")



### 参考答案

```python
from typing import Dict, Tuple


class Solution:
    def main(self, dict_: Dict[str, int]) -> Tuple[str]:

        dict_list0 = sorted(dict_.items(), key=lambda x:(-x[1], not x[0].islower(), x[0]))
        print(dict_list0)
        dict_list = []
        for key, value in dict_list0:
            dict_list.append(f"{key}")

        return tuple(dict_list)

z = Solution()
print(z.main({"e": 99, "A": 99, "V": 84, "E": 62}))
print(z.main({"F": 33, "r": 33, "c": 13, "v": 91, "n": 33, "L": 73}))

```



## 2.1 简单文本拆分

[荷塘月色-朱自清](http://zxbs.itmc.cn:80/pythonws1/data/user/5441/1665258219271880704/fj_cPFub90xZ-YW5W1wIXTFw.txt)

### 任务详情

统计《荷塘月色-朱自清》文本中文本字数超过（大于等于n）的中文字符词汇的数量.



### 任务要求

1.程序需要接收int类型的参数n,返回结果的数据类型是int;
2.只统计字数超过（大于等于n）的中文词汇;
3.按照行('\r','\r\n','\n')分隔文本数据,再对每一行数据使用jieba库精确模式分词.



### 测试用例

输入: n=4
输出: 12
解释: 《荷塘月色-朱自清》一文经过分词后,超过四个字的词语数目为12



输入: n=5
输出: 0



### 参考答案

```python
import jieba
import requests

class Solution:

    def main(self, n: int) -> int:
        url = "http://zxbs.itmc.cn:80/pythonws1/data/user/5441/1665258219271880704/fj_cPFub90xZ-YW5W1wIXTFw.txt"
        start = requests.get(url)
        start.encoding = "utf-8"
        txt_line = start.text.splitlines()
        end = 0
        for txt in txt_line:
            end += self.cheng_xu(txt,n)
        return end

    def cheng_xu(self,txt,n):
        word_list = jieba.lcut(txt)
        end = 0
        for word in word_list:
            if len(word) >= n:
                end += 1
        return end

z = Solution()
print(z.main(4))

```



```python
import requests
import jieba
class Solution:
    def main(self, n: int) -> int:
        io ='http://36.112.156.49:80/pythonws3/data/user/5696/1665258219271880704/fj_cPFub90xZ-YW5W1wIXTFw.txt'
        res=requests.get(io)
        res.encoding='utf-8'
        context=res.text
        # print(res)
        # 精确分词模式对应的方法是jieba.cut，该方法接受三个输入参数: 
        # jieba.cut(strt, cut_all=False, HMM=False)
        # 需要分词的字符串;
        # cut_all 参数用来控制是否采用全模式，值为False时表示采用精确分词模式;
        # HMM 参数用来控制是否使用 HMM 模型 ,作用是发现新词
        context =jieba.cut(context)
        # print(",".join(context))
        list=[]
        sum=0
        for i in context:
            if len(i) >=n:
                sum+=1
                list.append(i)  
        return sum


    
a=Solution()
print(a.main(n=4))

```



## 2.2 店铺销售情况整理

[店铺产品详情页](http://36.112.156.49/pythonws3/open/show/vDG2eacmK-0b8zq6BDtsC/index.html)

### 题目描述

下方链接是某店铺的商品列表,请编写程序,完成以下任务: 
程序传入商品标签cate name,要求以列表的形式返回属于该标签的商品的平均价格以及总销量.'宝贝排行榜','本店内推荐'栏目下的商品不纳入计算范围内.

注意: 

1.如果商品标题中含有cate name,则商品属于标签cate name,例如cate name='小白鞋'时,厚底小香风帆布女鞋子2022年新款春秋款休闲运动松糕小白鞋夏板包含小白鞋,则该商品属于小白鞋标签;

2.如果商品标题中含有多个标签cate name,则该商品属于多个标签.例如,透气老爹鞋门ins鞋子朝2022年新款百搭运动休闲小白鞋女鞋港风夏款包含小白鞋,老爹鞋等标签,那么需要计算属于该标签的商品多次.



### 题目要求

1.商品标签cate name为'所有分类及'款式'项目中的内容
2.程序接收str类型的cate name,返回list类型的结果
3.商品平均价格需要去掉金币符号且要保留两位小数
4.销量数据如果是1万+,视为10000;如果是100+,则视为100
5.如果没有找到cate name种类的商品,则返回字符串'无此类商品
6.商品的平均价格为字符串类型,总销量的数据类型为整数类型



### 测试用例

输入: cate name='运动鞋'
输出: ['68.00',600]
解释: 当cate name为运动鞋时,所有该种类的商品的平均价格是'68.00',总销量是600



### 参考答案

```python
import requests
from bs4 import BeautifulSoup


class Solution:
    def main(self, cate_name: str) -> list:
        url = "http://36.112.156.49/pythonws3/open/show/vDG2eacmK-0b8zq6BDtsC/index.html"
        start = requests.get(url)
        start.encoding = "utf-8"
        start = start.text
        html = BeautifulSoup(start,"lxml")
        html = html.find_all("a", class_="item-name J_TGoldData", limit=60)
        zong_jia_ge = 0
        zong_xiao_liang = 0
        i = 0
        for j in html:
            # print(i.string)
            if cate_name in j.string:
                html_end = j.parent.parent
                jia_ge = float(html_end.find("span", class_="c-price").string)
                xiao_liang = html_end.find("span", class_="sale-num").string
                if "万+" in xiao_liang:
                    xiao_liang = int(xiao_liang[:-2])
                elif "+" in xiao_liang:
                    xiao_liang = int(xiao_liang[:-1])
                else:
                    xiao_liang = int(xiao_liang)
                zong_jia_ge += jia_ge
                zong_xiao_liang += xiao_liang
                i += 1
                
        if i != 0:
            ping_jun_jia_ge = "{:.2f}".format(zong_jia_ge/i)
            return [ping_jun_jia_ge, zong_xiao_liang]

z = Solution()
print(z.main(cate_name="运动鞋"))

```



```python
import requests
from bs4 import BeautifulSoup


class Solution:
    def main(self, cate_name: str) -> list:

        url ='http://36.112.156.49/pythonws3/open/show/vDG2eacmK-0b8zq6BDtsC/index.html'
        res =requests.get(url)
        res.encoding='utf-8'
        context =res.text

        # print(context)
        soup =BeautifulSoup(context,'html.parser')
        #让你求摸一个商品的平均价格总销量

        #宝贝排行榜,,"本店内推荐,栏目下的商品不纳入计算范围内.
        sum=0
        sum_price=0
        sum_xiaoliang =0
        #剪切的整体范围
        soup_all =soup.find_all('div',class_='item4line1')[:-2]  
        for i in soup_all:
            #一整条
            i_=i.find_all('dl',class_='item')
            for j in i_:
                #每一条中的一个
                j_ =j.find('dd',class_='detail').a.string
                if cate_name in j_:
                    sum+=1
                    j_price=float(j.select("dd.detail >div.attribute >div.cprice-area >span.c-price")[0].string)
                    sum_price+=j_price
                    #总销量
                    j_xiaoliang=j.select("dd.detail >div.attribute >div.sale-area >span.sale-num")[0].string.replace('+','')
                    if '万' in j_xiaoliang:
                        xiaoliang =int(j_xiaoliang.split('万')[0])*10000
                    else:
                        xiaoliang=int(j_xiaoliang)
                    sum_xiaoliang+=xiaoliang

        return ["{:.2f}".format(float(sum_price)/sum),sum_xiaoliang]
    
a=Solution()
print(a.main(cate_name='运动鞋'))

```



## 3.1 学生平均成绩计算

### 任务详情

下表为两个班级中4名同学的期末考试成绩,需要计算每名同学的平均成绩.

![5df8e75884c91a7e6fee209a18a7725](https://gitee.com/fingerheart521/typora-image/raw/master/image/202311071936890.png)

请在表格中插入新的一列,列名为"Average",数值分别为每个同学的平均成绩,保留1位小数.插入后的效果如下: 

![image-20231107193835375](https://gitee.com/fingerheart521/typora-image/raw/master/image/202311071938420.png)

为防止人工对数据进行计算,函数接收含有一个元组变量请根据以上表格信息,借助Pandas库将右边函数补充完整.
比如tuple1=(1,2),表格内成绩的第二行第三列的数值68+1,变成69,再计算平均成绩: tuple.2=(0,3),表格内成绩的第一行第四列的数值60+1,变成61,再计算平均成绩.
函数将插入平均成绩的DataFrame数话结构返回.



### 任务要求

1.函数接收1个元组变量,函数返回对象为Pandas的DataFrame;
2.需要使用Pandas将表格转为对应的DataFrame;
3.请勿通过excel手工计算平均值.



### 测试用例

输入: (1,1)
输出: 

![image-20231107194125105](https://gitee.com/fingerheart521/typora-image/raw/master/image/202311071941151.png)

输入: (3,1)
输出: 

![image-20231107194147789](https://gitee.com/fingerheart521/typora-image/raw/master/image/202311071941832.png)

本任务,系统将遍历函数返回的DataFrame中的每个值,检验与内置测试用例是否一致.



### 参考答案

```python
import pandas as pd


class Solution:
    def main(self, test: tuple) -> 'DataFrame':
        # 为避免测试循环执行函数报错，建议在函数内生成DataFrame
        # 请将函数补充完整，使其返回正确的值
        # 从此处开始编写代码
        data = pd.DataFrame([
                    [94, 99, 89, 60],
                    [76, 56, 68, 58],
                    [91, 88, 89, 98],
                    [72, 54, 82, 62]],
                columns=['Math', 'Chinese', 'English', 'Physics'],
                index=['LiLei', 'HanMeiMei', 'ZhouQi', 'MaHua'])

        data.iloc[test[0],test[1]] = data.iloc[test[0],test[1]] + 1
        data["Average"] = data.mean(axis=1).round(1)
        return data
        
z = Solution()
print(z.main(test=(1,2)))

```



## 3.2 Pandas数组数学计算

### 题目描述

程序后台传入一个二维数组arr和一个一维数组col,要求使用arr和数组col创建数组,并完成如下工作.

1.需要使用二维数组arr和col创建pd.DataFrame对象df,arr构成df的主体,col构成df的列;
2.计算df中每列平均值,添加新的一行存储,行索引可采用当前索引最大值+1,平均值需要四舍五入保留小数点后2位;
3.df添加新的一列sum,Sum列的值是单行所有数值的乘积;
4.计算df中所有值的和.

将结果返回给程序后台.



### 题目要求

1.程序后台传入一个二维数组arr和一个一维数组col;
2.程序后台返回结果的数据类型是浮点数类型;
3.arr[0].length col.length;
4.np.floate64类型将不会被识别,请手动转换为float类型;
5.最后返回值需要四舍五入保留小数点后2位;
6,上述步骤不可颠倒,否则可能导致结果错误.



### 测试用例

输入: arr=[1,2,3],[4,5,6],col=[a',b,'c']
输出: 196.88
解释: 

![image-20231107195447036](https://gitee.com/fingerheart521/typora-image/raw/master/image/202311071954082.png)

添加新的一行（平均值）,结果: 

![image-20231107195654416](https://gitee.com/fingerheart521/typora-image/raw/master/image/202311071956456.png)

添加新的一列Sum(乘积),结果是: 

![image-20231107195741498](https://gitee.com/fingerheart521/typora-image/raw/master/image/202311071957541.png)

求和结果是: 196.88

输入: arr=[89,64,95,20],[70,85,45,84],[4,83,85,18],col=["urbfpv”,"sd","quri,"obg"]
输出: 46637483.31
输入: ar=[52,27],[32,38],[94,23],col=["xkti,"vs"]
输出: 6876.81



### 参考答案

```python
from typing import List

import pandas as pd


class Solution:
    def main(self, arr: List[List[int]], col: List[int]) -> float:
        """
        :param arr: 构建 df 需要的数据
        :param col: 构建 df 需要的列表
        :return: 返回结果
        """
        
        df = pd.DataFrame(arr, columns = col)
        
        df.loc[len(df.index)] = df.mean(axis=0).round(2)
        
        df["sum"] = df[col[0]]
        
        for i in range(len(col)):
            if i != 0:
                df["sum"] *= df[col[i]]
        df["sum"] = df["sum"].round(2)
        
        # df["sum"] = (df["a"] * df["b"] * df["c"]).round(2)
        
        return df.sum().sum()

z = Solution()
print(z.main(arr=[[1, 2, 3], [4, 5, 6]], col=["a", "b", "c"]))

```



## 3.3 公司员工工资统计

[职工工资计算](http://zxbs.itmc.cn:80/pythonws1/data/user/5441/1665161101253279744/fj_IrQae-Q_0Fj7ZehBYZMF2.xlsx)

### 任务说明

领导安排财务小刘汇总去年各部门工资花费情况,请编写程序帮助他.

程序给出一个月份month和一个部门名称pt,请你编写程序完成如下任务: 
1.请你编写程序钱到指定月份moth各个部门实际工资发放总额,工资发放情况按照升序排列,并返回给程序后台;
2.请你编写程序找到指定月份month销售部实际工资最高的人的姓名;
3.请你编写程序找到指定月份moth某部门p的实际工资平均值,平均值四舍五入保留小数点后2位;
提示: 需要合并表格数据后,实际发放工资.



### 任务要求

1.程序给定month数据类型是int,pt数据类型是str;
2.程序需要返回一个tuple数组,数组第一个元素是工资总额,总额需要转换为tuple形式,第二个元素最高工资的人,类型是str,第三个元素平均值数据类型是float.
3.实际工资=基本工资+工龄工资+津贴+提成-保险-个人所得税



### 测试用例

输入: month=10,pt='前台'
输出: (38627,47350,50626,57156,58754,69805,8055996076),'纪妙通',4653.67)
解释: 如上,10月份各个部门的发放排序(38627,47350,50626,57156,58754,69805,80559,96076),第10月工资实际工资最高的人是'纪妙通',10月份前台平均工资是4个3.67

输入: month=11,pt='销售部'
输出: (39401,46448,50468,57236,58120,69811,81061,93516),'宫秦祺',7193.54)
解释: 如上,11月份各个部门的发放排序(39401,46448,50468,57236,58120,69811,81061,93516),第11月工资实际工资最高的人是宫奏祺,11月份销售部平均工资是7193.54

输入: month=12,pt='前台'
输出: (39765,47892,50424,56988,58956,69873,80231,98662),'白凤',4658.2)



### 附件说明

职工工资计算
基本工资表
共包含100个员工8个部门的基本工资信息.

![image-20231107201855092](https://gitee.com/fingerheart521/typora-image/raw/master/image/202311072018147.png)

工资发放
工资发放表共包含8列1200条数据: 
数据为2022年1-12月的工资发放情况.
数据由程序模拟生成,可能与实际工资情况有所出入.

![image-20231107201952965](https://gitee.com/fingerheart521/typora-image/raw/master/image/202311072019017.png)



### 参考答案

```python
from typing import Tuple

import pandas as pd


class Solution:
    def main(self, month: int, pt: str) -> Tuple[Tuple[int], str, float]:
        url = "http://zxbs.itmc.cn:80/pythonws1/data/user/5441/1665161101253279744/fj_IrQae-Q_0Fj7ZehBYZMF2.xlsx"
        df1 = pd.read_excel(url,sheet_name="基本工资")
        df2 = pd.read_excel(url,sheet_name="工资发放")
        df = pd.merge(df1,df2)
        # print(df.head())
        df["实际工资"] = df["基本工资"] + df["工龄工资"] + df["津贴"] + df["提成"] - df["保险"] - df["个人所得税"]
        
        df["日期"] = pd.to_datetime(df["日期"])
        
        df_month = df[df["日期"].dt.month == month].sort_values(by="实际工资")
        
        ge_bu_men_shi_ji = tuple(df_month.groupby("部门").sum()["实际工资"].sort_values().tolist())

        end_xing_ming = list(df_month["姓名"])[-1]
        
        bu_men_shi_ji_ping_jun = df_month[df_month["部门"] == pt]["实际工资"].mean().round(2)

        return (ge_bu_men_shi_ji,end_xing_ming,bu_men_shi_ji_ping_jun)
	
z = Solution()
print(z.main(10,"前台"))

```



## 3.4 产品销售统计汇总

[产品销售表](http://36.112.156.49/pythonws3/data/user/5696/1665161117443293184/fj_Te7kTRzp3SKEhEUVEKNSs.xlsx')

### 任务说明

小王是公司一个运营组小组长,他想分析下今年全年产品运营情况.
请你编写程序帮助他,表格详情见附件说明.
1.小王想知道指定客服name全年休班天数.如果某天值班表上设有某个name,说明该客服休班: 
2.小王想了解某个产品pro在month月份的销售总额.销售总额是全部客服在京东,拼多多和淘宝三个电商的累加值;
3.小王想找出今年指定month月份销售总额排名第rank的客服,排序采用降序排序,销售总额最多的排名第1.



### 任务要求

1.程序给定客服名称name,某产品名称pro,月份month和排名rank;
2.name数据类型是str,pro数据类型是str,month数据类型是int,rank的数据类型是int;
3.程序需要返回指定客服的全年休班天数,产品销售总额和一个客服名称;
4.全年天数按照365天计算,12月最后一天全员休息;
5.返回结果的数据类型是tuple,tuple中包含全年休班天数,产品销售总额和客服名称;
6.全年休班天数数据类型是int,产品销售总额数据类型是int,客服名称数据类型是str;
7.销售总额不存在重复的数据,rnk的排名唯一;
8.数据较多,运行可能较慢,请稍微等待.



### 测试用例

输入: name='左腾俭',pro='板栗',month=3,rank=3,
输出: (110,107667,范凤枫)
解释: 左腾俭今年休息了110天,板栗在3月的销售总额是107667,3月份销售量排行第三的是范凤枫

输入: name='谭寒',pro='核桃',month=10,rank=10,
输出: (123,118851,伍复)
解释: 谭寒今年休息了123天,核桃在10月的销售总额是118851,3月份销售量排行第10的是伍蔓

输入: ·计江,板栗,4,2
输出: (119,121072,"伍复)



### 附件说明

产品销售表
产品销售表包含某运营小组2022年1月1日到2022年12月30日之间的销售运营情况;
单条记录表示某客服在某天负责售卖某产品;
单挑记录表示某产品在各个平台的销售额;
数据由随机数生成,可能出现未来日期,属于正常现象;
如果某天并未出现过某客服的名称,说明某客服该日休班;
数据共有7395条.

![image-20231107203920363](https://gitee.com/fingerheart521/typora-image/raw/master/image/202311072039430.png)

```python
from typing import Tuple

import pandas as pd


class Solution:
    def main(self, name: str, pro: str, month: int, rank: int) -> Tuple[int, int, str]:
        url = "http://36.112.156.49:80/pythonws3/data/user/5696/1665161117443293184/fj_Te7kTRzp3SKEhEUVEKNSs.xlsx"
        df = pd.read_excel(url)

        df["日期"] = pd.to_datetime(df["日期"])

        xiu_ban_tian_shu = 365 - len(list(df[df["客服"] == name].groupby("日期")["客服"]))
        # print(xiu_ban_tian_shu)

        df["销售总额"] = df["淘宝"] + df["京东"] + df["拼多多"]
        chan_pin_xiao_shou_zong_e = df[(df["产品"] == pro) & (df["日期"].dt.month == month)]["销售总额"].sum()
        # print(chan_pin_xiao_shou_zong_e)

        df_xiao_guan = df[df["日期"].dt.month == month].groupby("客服")["销售总额"].sum().sort_values(ascending=False)
        # print(df_xiao_guan)
        xiao_guan = df_xiao_guan[df_xiao_guan[rank-1] == df_xiao_guan].index[0]
        # print(xiao_guan)
        return (xiu_ban_tian_shu, chan_pin_xiao_shou_zong_e, xiao_guan)

z = Solution()
print(z.main(name='计江',pro='板栗',month=4,rank=2))

```



```python
import pandas as pd
import numpy as np


from datetime import datetime
from typing import Tuple
class Solution:
    def main(self, name: str,pro:str,month: int,rank:int) -> Tuple[int, int, str]:
        io='http://36.112.156.49:80/pythonws3/data/user/5696/1665161117443293184/fj_Te7kTRzp3SKEhEUVEKNSs.xlsx'
        df =pd.read_excel(io)

        #时间编码
        df['日期']=pd.to_datetime(df['日期'])

        # 任务一: 指定客服 name 全年休班天数.
        df_name =df[df['客服']==name]
        race =int(365-(len(df_name)/3))

        # 任务二,了解某个产品 pro 在 month 月份的销售总额.销售总额是全部客服在京东,拼多多和淘宝三个电商的累加值
        df['日期.new']=df['日期'].dt.month
        df['销售总量']=df['淘宝']+df['京东']+df['拼多多']
        # print(df)
        df_numbers =df.loc[(df['产品']==pro) & (df['日期.new']==month),:]

        xiaoliang =df_numbers['销售总量'].sum()

        #任务三,今年指定 month 月份销售总额排名第 rank 的客服排序采用降序排序,销售总额最多的排名第 1
        df_mounth =df[df['日期.new']==month]
        df_rate =df_mounth[['客服','销售总量']].groupby('客服').sum()

        df_rate=df_rate.sort_values(by='销售总量',ascending=False)

        df_rate['排名']=df_rate['销售总量'].rank(ascending=False).astype(int)


        rate=df_rate[df_rate['排名']==rank].index[0]

        return [race,xiaoliang,rate]
# print(df_rate)
# print( [race,xiaoliang,rate])

a=Solution()
print(a.main(name='计江',pro='板栗',month=4,rank=2))

```

